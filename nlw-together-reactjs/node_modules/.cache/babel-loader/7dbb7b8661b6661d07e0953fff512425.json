{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useEffect, useState } from \"react\";\nimport { database } from \"../services/firebase\";\nimport { useAuth } from \"./useAuth\";\nexport function useRoom(roomId) {\n  _s();\n\n  const {\n    user\n  } = useAuth();\n  const [questions, setQuestions] = useState([]);\n  const [title, setTitle] = useState();\n  useEffect(() => {\n    const roomRef = database.ref(`rooms/${roomId}`);\n    roomRef.on('value', room => {\n      var _databaseRoom$questio;\n\n      const databaseRoom = room.val();\n      const firebaseQuestions = (_databaseRoom$questio = databaseRoom.questions) !== null && _databaseRoom$questio !== void 0 ? _databaseRoom$questio : {};\n      const parsedQuestions = Object.entries(firebaseQuestions).map(([key, value]) => {\n        var _value$likes, _value$likes2;\n\n        return {\n          id: key,\n          content: value.content,\n          author: value.author,\n          isHighLighted: value.isHighLighted,\n          isAnswered: value.isAnswered,\n          likeCount: Object.values((_value$likes = value.likes) !== null && _value$likes !== void 0 ? _value$likes : {}).length,\n          hasLiked: Object.values((_value$likes2 = value.likes) !== null && _value$likes2 !== void 0 ? _value$likes2 : {}).some(like => like.authorId === (user === null || user === void 0 ? void 0 : user.id))\n        };\n      });\n      setTitle(databaseRoom.title);\n      setQuestions(parsedQuestions);\n    });\n  }, [roomId]);\n  return {\n    questions,\n    title\n  };\n}\n\n_s(useRoom, \"FcjyfIjATRpD9Bt/n5NYxfXc0NQ=\", false, function () {\n  return [useAuth];\n});","map":{"version":3,"sources":["/home/brenoangelo/Documents/rocketseat/nwl-together-reactjs/letmeask/src/hooks/useRoom.ts"],"names":["useEffect","useState","database","useAuth","useRoom","roomId","user","questions","setQuestions","title","setTitle","roomRef","ref","on","room","databaseRoom","val","firebaseQuestions","parsedQuestions","Object","entries","map","key","value","id","content","author","isHighLighted","isAnswered","likeCount","values","likes","length","hasLiked","some","like","authorId"],"mappings":";;AAAA,SAASA,SAAT,EAAoBC,QAApB,QAAoC,OAApC;AACA,SAASC,QAAT,QAAyB,sBAAzB;AACA,SAASC,OAAT,QAAwB,WAAxB;AA0BA,OAAO,SAASC,OAAT,CAAiBC,MAAjB,EAAgC;AAAA;;AACnC,QAAM;AAAEC,IAAAA;AAAF,MAAWH,OAAO,EAAxB;AACA,QAAM,CAACI,SAAD,EAAYC,YAAZ,IAA4BP,QAAQ,CAAiB,EAAjB,CAA1C;AACA,QAAM,CAACQ,KAAD,EAAQC,QAAR,IAAoBT,QAAQ,EAAlC;AAEAD,EAAAA,SAAS,CAAC,MAAI;AACV,UAAMW,OAAO,GAAGT,QAAQ,CAACU,GAAT,CAAc,SAAQP,MAAO,EAA7B,CAAhB;AAEAM,IAAAA,OAAO,CAACE,EAAR,CAAW,OAAX,EAAoBC,IAAI,IAAI;AAAA;;AACvB,YAAMC,YAAY,GAAGD,IAAI,CAACE,GAAL,EAArB;AACA,YAAMC,iBAAoC,4BAAGF,YAAY,CAACR,SAAhB,yEAA6B,EAAvE;AAEA,YAAMW,eAAe,GAAGC,MAAM,CAACC,OAAP,CAAeH,iBAAf,EAAkCI,GAAlC,CAAsC,CAAC,CAACC,GAAD,EAAMC,KAAN,CAAD,KAAkB;AAAA;;AAC5E,eAAO;AACHC,UAAAA,EAAE,EAAEF,GADD;AAEHG,UAAAA,OAAO,EAAEF,KAAK,CAACE,OAFZ;AAGHC,UAAAA,MAAM,EAAEH,KAAK,CAACG,MAHX;AAIHC,UAAAA,aAAa,EAAEJ,KAAK,CAACI,aAJlB;AAKHC,UAAAA,UAAU,EAAEL,KAAK,CAACK,UALf;AAMHC,UAAAA,SAAS,EAAEV,MAAM,CAACW,MAAP,iBAAcP,KAAK,CAACQ,KAApB,uDAA6B,EAA7B,EAAiCC,MANzC;AAOHC,UAAAA,QAAQ,EAAEd,MAAM,CAACW,MAAP,kBAAcP,KAAK,CAACQ,KAApB,yDAA6B,EAA7B,EAAiCG,IAAjC,CAAsCC,IAAI,IAAIA,IAAI,CAACC,QAAL,MAAkB9B,IAAlB,aAAkBA,IAAlB,uBAAkBA,IAAI,CAAEkB,EAAxB,CAA9C;AAPP,SAAP;AASH,OAVuB,CAAxB;AAYAd,MAAAA,QAAQ,CAACK,YAAY,CAACN,KAAd,CAAR;AACAD,MAAAA,YAAY,CAACU,eAAD,CAAZ;AAEJ,KAnBD;AAoBF,GAvBO,EAuBN,CAACb,MAAD,CAvBM,CAAT;AAyBC,SAAO;AAAEE,IAAAA,SAAF;AAAaE,IAAAA;AAAb,GAAP;AACJ;;GA/BeL,O;UACKD,O","sourcesContent":["import { useEffect, useState } from \"react\"\nimport { database } from \"../services/firebase\"\nimport { useAuth } from \"./useAuth\"\n\ntype FirebaseQuestions = Record<string, {\n    author: {\n        name: string;\n       avatar: string;\n    },\n    content: string;\n    isAnswered: boolean;\n    isHighLighted: boolean; \n    likes: Record<string, {\n\n    }>;\n}>\n\ntype QuestionType = {\n    id: string;\n    author: {\n        name: string;\n       avatar: string;\n    },\n    content: string;\n    isAnswered: boolean;\n    isHighLighted: boolean; \n}\n\nexport function useRoom(roomId: string){\n    const { user } = useAuth()\n    const [questions, setQuestions] = useState<QuestionType[]>([])\n    const [title, setTitle] = useState()\n\n    useEffect(()=>{\n        const roomRef = database.ref(`rooms/${roomId}`) \n \n        roomRef.on('value', room => {\n             const databaseRoom = room.val();\n             const firebaseQuestions: FirebaseQuestions = databaseRoom.questions ?? {}; \n \n             const parsedQuestions = Object.entries(firebaseQuestions).map(([key, value]) => {\n                 return {\n                     id: key,\n                     content: value.content,\n                     author: value.author,\n                     isHighLighted: value.isHighLighted,\n                     isAnswered: value.isAnswered,\n                     likeCount: Object.values(value.likes ?? {}).length,\n                     hasLiked: Object.values(value.likes ?? {}).some(like => like.authorId === user?.id),\n                 }\n             })\n             \n             setTitle(databaseRoom.title)\n             setQuestions(parsedQuestions)\n            \n        })\n     },[roomId])\n\n     return { questions, title }\n}"]},"metadata":{},"sourceType":"module"}